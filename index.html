<!doctype html>
<html lang="el">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EU Political Quiz</title>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <style>
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:#0b1020;
      color:#e5e7eb;
    }
    .wrap{max-width:900px;margin:0 auto;padding:18px}
    h1{margin:0 0 6px;font-size:22px}
    .sub{color:#9ca3af;font-size:14px;margin-bottom:14px}
    .card{
      background:#111827;
      border:1px solid #1f2937;
      border-radius:14px;
      padding:14px;
      margin-bottom:12px;
    }
    .q{font-weight:600;margin-bottom:8px}
    input,select{
      width:100%;
      padding:12px;
      border-radius:10px;
      border:1px solid #374151;
      background:#020617;
      color:#e5e7eb;
      font-size:15px;
    }
    button{
      padding:12px 16px;
      border-radius:10px;
      border:0;
      font-size:15px;
      font-weight:700;
      cursor:pointer;
    }
    .primary{background:#60a5fa;color:#020617}
    .ghost{background:transparent;border:1px solid #374151;color:#e5e7eb}
    .row{display:flex;gap:10px;flex-wrap:wrap}
    .hide{display:none}
    canvas{width:100%!important;height:auto!important}
  </style>
</head>

<body>
<div class="wrap">
  <h1>Πολιτικός Προσανατολισμός (ΕΕ)</h1>
  <p class="sub">Απάντησε και δες το αποτέλεσμα με γράφημα & συμπέρασμα.</p>

  <form id="quiz" class="card">
    <div class="q">Email</div>
    <input type="email" name="email" id="email" required placeholder="name@email.com">

    <div id="questions"></div>

    <div class="row" style="margin-top:12px">
      <button class="primary" type="submit">Δες αποτέλεσμα</button>
      <button class="ghost" type="button" onclick="location.reload()">Reset</button>
    </div>
  </form>

  <div id="results" class="card hide">
    <h3>Αποτέλεσμα</h3>
    <p id="summary" class="sub"></p>

    <canvas id="barChart"></canvas>
    <br>
    <canvas id="radarChart"></canvas>

    <div class="card" style="margin-top:12px">
      <b>Συμπέρασμα</b>
      <p id="conclusion" class="sub"></p>
    </div>
  </div>
</div>

<script>
  const FORMSPREE_ENDPOINT = "https://formspree.io/f/xbdyzgbw";

  const QUESTIONS = [
    {id:"q1", t:"Το κράτος πρέπει να μειώνει τις ανισότητες.", econ:-1, soc:0},
    {id:"q2", t:"Η ελεύθερη αγορά φέρνει ανάπτυξη.", econ:1, soc:0},
    {id:"q3", t:"Υψηλότεροι φόροι στους πλούσιους είναι αναγκαίοι.", econ:-1, soc:0},
    {id:"q4", t:"Οι ιδιωτικοποιήσεις βελτιώνουν υπηρεσίες.", econ:1, soc:0},

    {id:"q5", t:"Τα δικαιώματα μειονοτήτων πρέπει να προστατεύονται.", econ:0, soc:-1},
    {id:"q6", t:"Η τάξη και ασφάλεια είναι προτεραιότητα.", econ:0, soc:1},
    {id:"q7", t:"Η μετανάστευση χρειάζεται αυστηρότερους κανόνες.", econ:0, soc:1},
    {id:"q8", t:"Η ΕΕ πρέπει να πιέζει για πολιτικές κλίματος.", econ:-0.5, soc:-0.5},
    {id:"q9", t:"Η ελευθερία λόγου χρειάζεται όρια.", econ:0, soc:1},
    {id:"q10",t:"Δημόσιες δαπάνες σε υγεία/παιδεία πρέπει να αυξηθούν.", econ:-1, soc:0},
  ];

  const SCALE = [
    ["","— επίλεξε —"],
    [-2,"-2 Διαφωνώ απόλυτα"],
    [-1,"-1 Διαφωνώ"],
    [0,"0 Ούτε/ούτε"],
    [1,"+1 Συμφωνώ"],
    [2,"+2 Συμφωνώ απόλυτα"],
  ];

  const qs = document.getElementById("questions");
  QUESTIONS.forEach(q=>{
    qs.innerHTML += `
      <div class="card">
        <div class="q">${q.t}</div>
        <select id="${q.id}">
          ${SCALE.map(s=>`<option value="${s[0]}">${s[1]}</option>`).join("")}
        </select>
      </div>`;
  });

  function clamp(n){return Math.max(-100,Math.min(100,n));}

  document.getElementById("quiz").addEventListener("submit", async e=>{
    e.preventDefault();

    let econ=0,soc=0,answers={};
    for(const q of QUESTIONS){
      const v=parseInt(document.getElementById(q.id).value);
      if(isNaN(v)) return alert("Απάντησε όλες τις ερωτήσεις");
      econ+=v*q.econ;
      soc+=v*q.soc;
      answers[q.id]=v;
    }

    const econPct=clamp(Math.round(econ*10));
    const socPct=clamp(Math.round(soc*10));

    document.getElementById("results").classList.remove("hide");
    document.getElementById("summary").textContent =
      `Οικονομία: ${econPct}, Κοινωνικά: ${socPct}`;

    new Chart(barChart,{
      type:"bar",
      data:{labels:["Οικονομία","Κοινωνικά"],datasets:[{data:[econPct,socPct]}]},
      options:{scales:{y:{min:-100,max:100}}}
    });

    new Chart(radarChart,{
      type:"radar",
      data:{labels:["Οικονομία","Κοινωνικά"],datasets:[{data:[econPct,socPct],fill:true}]},
      options:{scales:{r:{min:-100,max:100}}}
    });

    const conclusion =
      `Οικονομικά ${econPct<0?"πιο αριστερά":"πιο δεξιά"}, `+
      `κοινωνικά ${socPct<0?"πιο φιλελεύθερος":"πιο συντηρητικός"}.`;

    document.getElementById("conclusion").textContent = conclusion;

    const fd=new FormData();
    fd.append("email",document.getElementById("email").value);
    fd.append("econ",econPct);
    fd.append("soc",socPct);
    fd.append("conclusion",conclusion);
    fd.append("answers",JSON.stringify(answers));

    fetch(FORMSPREE_ENDPOINT,{method:"POST",body:fd,headers:{Accept:"application/json"}});
  });
</script>
</body>
</html>
