<!doctype html>
<html lang="el">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EU Political Profile</title>

  <style>
    :root{
      --bg:#f7f7f7;
      --paper:#ffffff;
      --ink:#111111;
      --muted:#666666;
      --line:#d9d9d9;
      --accent:#b30000; /* restrained Economist-ish red */
      --field:#ffffff;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:var(--bg);
      color:var(--ink);
      font-family: ui-serif, Georgia, "Times New Roman", Times, serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    .wrap{max-width:980px;margin:0 auto;padding:18px}

    .mast{
      background:var(--paper);
      border:1px solid var(--line);
      border-radius:10px;
      padding:18px 16px;
    }
    .kicker{
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      letter-spacing:.14em;
      text-transform:uppercase;
      font-size:11px;
      color:var(--muted);
      margin:0 0 8px;
    }
    .rule{height:2px;background:var(--accent);width:56px;margin:10px 0 12px}
    h1{
      margin:0;
      font-size:26px;
      line-height:1.08;
      letter-spacing:-.01em;
    }
    .dek{
      margin:10px 0 0;
      color:var(--muted);
      font-size:15px;
      line-height:1.45;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }

    .grid{display:grid;gap:12px;margin-top:12px;grid-template-columns:1fr}
    @media(min-width:900px){ .grid{grid-template-columns:1.15fr .85fr} }

    .card{
      background:var(--paper);
      border:1px solid var(--line);
      border-radius:10px;
      padding:14px;
    }
    .sectionTitle{
      margin:0 0 10px;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      font-weight:800;
      font-size:12px;
      letter-spacing:.12em;
      text-transform:uppercase;
      color:var(--ink);
    }

    label{
      display:block;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      font-size:12px;
      letter-spacing:.10em;
      text-transform:uppercase;
      color:var(--muted);
      margin-bottom:6px;
    }
    input[type="email"]{
      width:100%;
      padding:12px 12px;
      border-radius:8px;
      border:1px solid var(--line);
      background:var(--field);
      color:var(--ink);
      font-size:15px;
      outline:none;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }

    .qBlock{
      border-top:1px solid var(--line);
      padding-top:12px;
      margin-top:12px;
    }
    .qText{
      margin:0 0 10px;
      font-size:16px;
      line-height:1.35;
    }
    select{
      width:100%;
      padding:12px;
      border-radius:8px;
      border:1px solid var(--line);
      background:var(--field);
      color:var(--ink);
      font-size:15px;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }

    .btnbar{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    button{
      border-radius:8px;
      padding:12px 14px;
      font-size:14px;
      cursor:pointer;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      font-weight:800;
      letter-spacing:.03em;
      text-transform:uppercase;
    }
    .primary{
      border:1px solid var(--ink);
      background:var(--ink);
      color:white;
    }
    .ghost{
      border:1px solid var(--line);
      background:transparent;
      color:var(--ink);
    }

    .msg{
      margin-top:10px;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      font-size:13px;
      line-height:1.35;
    }
    .err{color:#8b0000;font-weight:800}
    .ok{color:#0f6d3a;font-weight:800}
    .hide{display:none}

    /* Results */
    .summary{
      margin:6px 0 0;
      color:var(--muted);
      font-size:14px;
      line-height:1.45;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }
    .metric{
      margin-top:12px;
      border-top:1px solid var(--line);
      padding-top:12px;
    }
    .metricHead{
      display:flex;justify-content:space-between;gap:10px;align-items:baseline;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }
    .metricName{
      font-weight:900;
      letter-spacing:.12em;
      text-transform:uppercase;
      font-size:12px;
      color:var(--ink)
    }
    .metricVal{font-weight:900;color:var(--ink);font-size:12px}
    .barRow{
      display:grid;
      grid-template-columns:auto 1fr auto;
      gap:10px;
      align-items:center;
      margin-top:10px;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      font-size:12px;
      color:var(--muted);
    }
    .bar{
      height:10px;
      background:#f0f0f0;
      border:1px solid var(--line);
      border-radius:999px;
      overflow:hidden;
      position:relative;
    }
    .bar .mid{
      position:absolute;left:50%;top:-3px;bottom:-3px;width:1px;background:#c7c7c7;
    }
    .fill{
      height:100%;
      width:50%;
      background:var(--ink);
    }
    .fine{
      margin:8px 0 0;
      color:var(--muted);
      font-size:13px;
      line-height:1.45;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }
    .conclusion{
      margin:10px 0 0;
      font-size:16px;
      line-height:1.45;
    }

    /* Compass */
    .compassWrap{margin-top:14px}
    .compassTitle{
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      font-weight:900;
      letter-spacing:.12em;
      text-transform:uppercase;
      font-size:12px;
      color:var(--ink);
      margin:0 0 8px;
    }
    .compass{
      position:relative;
      width:100%;
      aspect-ratio: 1 / 1;
      max-width:360px;
      border:1px solid var(--line);
      background:
        linear-gradient(90deg, transparent 49.5%, #c7c7c7 50%, transparent 50.5%),
        linear-gradient(180deg, transparent 49.5%, #c7c7c7 50%, transparent 50.5%),
        #ffffff;
      border-radius:10px;
      overflow:hidden;
    }
    .axisLabel{
      position:absolute;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      font-size:11px;
      letter-spacing:.10em;
      text-transform:uppercase;
      color:var(--muted);
    }
    .labTop{top:10px;left:50%;transform:translateX(-50%)}
    .labBottom{bottom:10px;left:50%;transform:translateX(-50%)}
    .labLeft{left:10px;top:50%;transform:translateY(-50%) rotate(-90deg)}
    .labRight{right:10px;top:50%;transform:translateY(-50%) rotate(90deg)}
    .dot{
      position:absolute;
      width:12px;height:12px;border-radius:50%;
      background:var(--accent);
      border:2px solid white;
      transform:translate(-50%,-50%);
    }
    .note{
      margin-top:10px;
      color:var(--muted);
      font-size:12px;
      line-height:1.45;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="mast">
      <p class="kicker">EU PUBLIC OPINION</p>
      <div class="rule"></div>
      <h1>Πολιτικό Προφίλ — δύο άξονες</h1>
      <p class="dek">
        Απάντησε σε 10 δηλώσεις και δες καθαρή σύνοψη σε <b>Οικονομία</b> και <b>Κοινωνικά</b>.
      </p>
    </div>

    <div class="grid">
      <div class="card">
        <div class="sectionTitle">Questionnaire</div>

        <form id="quiz" autocomplete="on">
          <label for="email">Email</label>
          <input id="email" name="email" type="email" placeholder="name@email.com" required />

          <div id="questions"></div>

          <div class="btnbar">
            <button class="primary" type="submit">Αποτέλεσμα</button>
            <button class="ghost" type="button" id="resetBtn">Reset</button>
          </div>

          <div id="msgErr" class="msg err hide"></div>
          <div id="msgOk" class="msg ok hide"></div>
        </form>
      </div>

      <div class="card">
        <div class="sectionTitle">Result</div>

        <div id="results" class="hide">
          <p id="summary" class="summary"></p>

          <div class="metric">
            <div class="metricHead">
              <div class="metricName">Οικονομία</div>
              <div class="metricVal" id="econVal">—</div>
            </div>
            <div class="barRow">
              <span>Αριστερά</span>
              <div class="bar"><div class="mid"></div><div class="fill" id="econBar"></div></div>
              <span>Δεξιά</span>
            </div>
            <p class="fine" id="econText"></p>
          </div>

          <div class="metric">
            <div class="metricHead">
              <div class="metricName">Κοινωνικά</div>
              <div class="metricVal" id="socVal">—</div>
            </div>
            <div class="barRow">
              <span>Φιλελεύθερα</span>
              <div class="bar"><div class="mid"></div><div class="fill" id="socBar"></div></div>
              <span>Συντηρητικά</span>
            </div>
            <p class="fine" id="socText"></p>
          </div>

          <div class="compassWrap">
            <div class="compassTitle">Political compass</div>
            <div class="compass">
              <div class="axisLabel labTop">Φιλελεύθερα</div>
              <div class="axisLabel labBottom">Συντηρητικά</div>
              <div class="axisLabel labLeft">Αριστερά</div>
              <div class="axisLabel labRight">Δεξιά</div>
              <div class="dot" id="dot" style="left:50%;top:50%"></div>
            </div>
            <div class="note">*Ενδεικτική αποτύπωση (όχι “ταμπέλα”).</div>
          </div>

          <div class="metric">
            <div class="metricHead">
              <div class="metricName">Συμπέρασμα</div>
            </div>
            <p class="conclusion" id="conclusion"></p>
          </div>
        </div>

        <div id="resultsEmpty" class="summary">
          Συμπλήρωσε το ερωτηματολόγιο για να εμφανιστεί το αποτέλεσμα.
        </div>
      </div>
    </div>
  </div>

<script>
  // ✅ κρατάμε αυτό όπως δουλεύει ήδη
  const FORMSPREE_ENDPOINT = "https://formspree.io/f/xbdyzgbw";

  const SCALE = [
    { v:"",  t:"— επίλεξε —" },
    { v:"-2",t:"-2  Διαφωνώ απόλυτα" },
    { v:"-1",t:"-1  Διαφωνώ" },
    { v:"0", t:"0   Ούτε/ούτε" },
    { v:"1", t:"+1  Συμφωνώ" },
    { v:"2", t:"+2  Συμφωνώ απόλυτα" },
  ];

  // 10 statements, weights on 2 axes
  const QUESTIONS = [
    { id:"q1", text:"Το κράτος πρέπει να μειώνει ενεργά τις κοινωνικές ανισότητες.", econ:-1, soc:0 },
    { id:"q2", text:"Οι υψηλότεροι φόροι στους πολύ εύπορους είναι απαραίτητοι για κοινωνική συνοχή.", econ:-1, soc:0 },
    { id:"q3", text:"Η αγορά (με σωστή ρύθμιση) είναι ο καλύτερος μηχανισμός ανάπτυξης.", econ:+1, soc:0 },
    { id:"q4", text:"Οι ιδιωτικοποιήσεις μπορούν να βελτιώσουν την ποιότητα υπηρεσιών σε αρκετούς τομείς.", econ:+1, soc:0 },

    { id:"q5", text:"Τα δικαιώματα μειονοτήτων πρέπει να προστατεύονται ακόμη κι αν ενοχλεί την πλειοψηφία.", econ:0, soc:-1 },
    { id:"q6", text:"Σε κρίσεις, η τάξη/ασφάλεια πρέπει να προηγείται της ατομικής ελευθερίας.", econ:0, soc:+1 },
    { id:"q7", text:"Η μετανάστευση χρειάζεται αυστηρότερους κανόνες για κοινωνική σταθερότητα.", econ:0, soc:+1 },
    { id:"q8", text:"Η ΕΕ πρέπει να επιβάλει ισχυρούς κανόνες για το κλίμα ακόμη κι αν κοστίζουν βραχυπρόθεσμα.", econ:-0.5, soc:-0.5 },
    { id:"q9", text:"Η ελευθερία λόγου πρέπει να έχει όρια όταν προκαλεί κοινωνική βλάβη.", econ:0, soc:+1 },
    { id:"q10", text:"Οι δημόσιες δαπάνες σε υγεία/παιδεία πρέπει να αυξηθούν.", econ:-1, soc:0 },
  ];

  const $ = (sel) => document.querySelector(sel);

  function showErr(t){ $("#msgErr").textContent=t; $("#msgErr").classList.remove("hide"); $("#msgOk").classList.add("hide"); }
  function showOk(t){ $("#msgOk").textContent=t; $("#msgOk").classList.remove("hide"); $("#msgErr").classList.add("hide"); }
  function clearMsgs(){ $("#msgErr").classList.add("hide"); $("#msgOk").classList.add("hide"); }

  function renderQuestions(){
    const host = $("#questions");
    host.innerHTML = "";
    QUESTIONS.forEach((q, i) => {
      const div = document.createElement("div");
      div.className = "qBlock";
      div.innerHTML = `
        <p class="qText"><b>${i+1}.</b> ${q.text}</p>
        <select id="${q.id}" name="${q.id}" required>
          ${SCALE.map(o=>`<option value="${o.v}">${o.t}</option>`).join("")}
        </select>
      `;
      host.appendChild(div);
    });
  }

  function clamp(n,min,max){ return Math.max(min, Math.min(max, n)); }

  function computeScores(){
    let econ=0, soc=0;
    const answers = {};
    for(const q of QUESTIONS){
      const v = parseInt($("#"+q.id).value, 10);
      if (Number.isNaN(v)) return null;
      answers[q.id] = v;
      econ += v * q.econ;
      soc  += v * q.soc;
    }

    const econMax = QUESTIONS.reduce((s,q)=> s + Math.abs(q.econ)*2, 0) || 1;
    const socMax  = QUESTIONS.reduce((s,q)=> s + Math.abs(q.soc)*2, 0) || 1;

    const econPct = Math.round(clamp((econ / econMax) * 100, -100, 100));
    const socPct  = Math.round(clamp((soc  / socMax)  * 100, -100, 100));

    return { econPct, socPct, answers };
  }

  function labelEcon(e){
    if (e <= -50) return "σαφώς πιο αριστερά";
    if (e <= -20) return "ήπια προς αριστερά";
    if (e <  20)  return "κεντρώα οικονομική στάση";
    if (e <  50)  return "ήπια προς δεξιά";
    return "σαφώς πιο δεξιά";
  }
  function labelSoc(s){
    if (s <= -50) return "σαφώς πιο φιλελεύθερα";
    if (s <= -20) return "ήπια πιο φιλελεύθερα";
    if (s <  20)  return "κεντρώα κοινωνική στάση";
    if (s <  50)  return "ήπια πιο συντηρητικά";
    return "σαφώς πιο συντηρητικά";
  }

  function conclusionText(econPct, socPct){
    let profile = "";
    if (econPct < -15 && socPct < -15) profile = "προοδευτικό/κοινωνικά ανοιχτό με έμφαση σε κοινωνικό κράτος";
    else if (econPct > 15 && socPct < -15) profile = "φιλελεύθερο οικονομικά με κοινωνικά ανοιχτές θέσεις";
    else if (econPct < -15 && socPct > 15) profile = "κοινωνικό οικονομικά με πιο παραδοσιακές κοινωνικές θέσεις";
    else if (econPct > 15 && socPct > 15) profile = "πιο δεξιά οικονομικά και πιο συντηρητικό κοινωνικά";
    else profile = "μικτό/κεντρώο προφίλ χωρίς έντονη κλίση";

    return `Οικονομικά είσαι ${labelEcon(econPct)} και κοινωνικά ${labelSoc(socPct)}. Συνολικά, προκύπτει <b>${profile}</b>.`;
  }

  function setBar(id, scorePct){
    const w = (scorePct + 100) / 2; // -100..100 => 0..100
    $(id).style.width = w + "%";
  }

  function setCompassDot(econPct, socPct){
    const x = (econPct + 100) / 2;
    const y = (socPct + 100) / 2; // liberal top (-) => smaller => closer to top
    $("#dot").style.left = x + "%";
    $("#dot").style.top  = y + "%";
  }

  async function sendToFormspree(payload){
    // Σιωπηλή αποστολή στο background — δεν εμφανίζουμε τίποτα στον χρήστη.
    const fd = new FormData();
    fd.append("email", payload.email);
    fd.append("econ", payload.econPct);
    fd.append("soc", payload.socPct);
    fd.append("conclusion", payload.conclusionPlain);
    fd.append("answers_json", JSON.stringify(payload.answers));
    fd.append("subject", `EU Quiz: Econ ${payload.econPct}, Soc ${payload.socPct}`);
    fd.append("message",
`Email: ${payload.email}
Econ: ${payload.econPct}
Soc: ${payload.socPct}
Συμπέρασμα: ${payload.conclusionPlain}

Απαντήσεις: ${JSON.stringify(payload.answers)}
`);

    const res = await fetch(FORMSPREE_ENDPOINT, {
      method: "POST",
      body: fd,
      headers: { "Accept": "application/json" }
    });

    if(!res.ok){
      const txt = await res.text().catch(()=> "");
      throw new Error("Formspree failed: " + res.status + " " + txt);
    }
  }

  renderQuestions();

  $("#resetBtn").addEventListener("click", ()=>{
    document.getElementById("quiz").reset();
    $("#results").classList.add("hide");
    $("#resultsEmpty").classList.remove("hide");
    clearMsgs();
  });

  $("#quiz").addEventListener("submit", async (e)=>{
    e.preventDefault();
    clearMsgs();

    const email = $("#email").value.trim();
    if(!email){ showErr("Βάλε email."); return; }

    const scores = computeScores();
    if(!scores){ showErr("Απάντησε σε όλες τις ερωτήσεις."); return; }

    const { econPct, socPct, answers } = scores;

    // UI
    $("#results").classList.remove("hide");
    $("#resultsEmpty").classList.add("hide");
    $("#summary").textContent = `Σκορ: Οικονομία ${econPct} • Κοινωνικά ${socPct}`;

    $("#econVal").textContent = econPct;
    $("#socVal").textContent  = socPct;

    setBar("#econBar", econPct);
    setBar("#socBar", socPct);

    $("#econText").textContent = `Ερμηνεία: ${labelEcon(econPct)}.`;
    $("#socText").textContent  = `Ερμηνεία: ${labelSoc(socPct)}.`;

    const concHTML = conclusionText(econPct, socPct);
    $("#conclusion").innerHTML = concHTML;
    const concPlain = concHTML.replace(/<[^>]*>/g, "");

    setCompassDot(econPct, socPct);

    // Silent send (no visible messaging)
    try {
      await sendToFormspree({ email, econPct, socPct, answers, conclusionPlain: concPlain });
    } catch (err) {
      // σκόπιμα "σιωπηλό" — δεν δείχνουμε τίποτα στον χρήστη
      console.error(err);
    }
  });
</script>
</body>
</html>
